# TailorCloud MVP 開発進捗管理

**作成日**: 2025-01  
**バージョン**: 1.0.0  
**対象**: Phase 1 MVP（個人テーラー向け）  
**目標**: 1ヶ月以内に知り合いのテーラー10人が実務で使えるプロトタイプ

---

## 📊 全体進捗サマリー

| カテゴリ | 進捗率 | 状態 |
|---------|--------|------|
| **バックエンドAPI** | 85% | 🟢 ほぼ完了 |
| **フロントエンド** | 85% | 🟢 ほぼ完了 |
| **データベース** | 100% | ✅ 完了 |
| **認証・セキュリティ** | 100% | ✅ 完了 |
| **コンプライアンス機能** | 90% | 🟢 ほぼ完了 |
| **インフラ構成** | 0% | 🔴 未着手 |
| **テスト** | 20% | 🔴 未着手 |

**全体進捗**: **約80%**

---

## 1. バックエンドAPI進捗

### 1.1 実装済みAPI ✅

#### 顧客管理（CRM）
- ✅ `POST /api/customers` - 顧客作成
- ✅ `GET /api/customers` - 顧客一覧取得（検索対応）
- ✅ `GET /api/customers/{id}` - 顧客取得
- ✅ `PUT /api/customers/{id}` - 顧客更新
- ✅ `DELETE /api/customers/{id}` - 顧客削除
- ✅ `GET /api/customers/{id}/orders` - 顧客の注文履歴

**進捗**: 100% ✅

#### 注文管理
- ✅ `POST /api/orders` - 注文作成
- ✅ `POST /api/orders/confirm` - 注文確定
- ✅ `GET /api/orders` - 注文取得・一覧
- ✅ `POST /api/orders/{id}/generate-document` - 発注書PDF生成
- ✅ `POST /api/orders/{id}/generate-amendment` - 修正発注書生成

**進捗**: 100% ✅

#### 生地管理
- ✅ `GET /api/fabrics` - 生地一覧取得（フィルター・検索対応）
- ✅ `GET /api/fabrics/detail` - 生地詳細取得
- ✅ `POST /api/fabrics/reserve` - 生地確保

**進捗**: 100% ✅

#### コンプライアンス文書
- ✅ `POST /api/orders/{id}/generate-document` - 発注書PDF生成
- ✅ `POST /api/orders/{id}/generate-amendment` - 修正発注書生成
- ⚠️ `GET /api/orders/{id}/compliance-documents` - 発注書履歴取得（実装済みだが、MVP仕様との差分確認必要）
- ⚠️ `GET /api/compliance-documents/{document_id}/download` - PDFダウンロード（実装確認必要）

**進捗**: 90% 🟢

### 1.2 MVP仕様との差分（要実装）

#### 注文管理（差分）
- ⚠️ `POST /api/orders` - **order_items配列対応**（現在は単一アイテム想定？）
- ⚠️ `GET /api/orders/{id}` - **注文明細（order_items）を含む詳細レスポンス**（実装確認必要）

#### コンプライアンス文書（差分）
- ⚠️ `GET /api/compliance-documents/{document_id}/download` - PDFダウンロードエンドポイント（実装確認必要）

**優先度**: 🟡 中（動作確認してから判断）

---

## 2. フロントエンド進捗

### 2.1 実装済み画面 ✅

#### ホーム画面
- ✅ `lib/screens/home/home_screen.dart` - ホーム画面（Dashboard）
  - KPI表示
  - クイックアクション
  - 最近の注文一覧

**進捗**: 80% 🟢（MVP仕様との差分確認必要）

#### 在庫画面
- ✅ `lib/screens/inventory/inventory_screen.dart` - 生地一覧画面
  - 生地一覧表示
  - 検索・フィルター機能
  - 在庫ステータス表示

**進捗**: 90% 🟢

#### 注文画面
- ✅ `lib/screens/order/quick_order_screen.dart` - クイック発注画面（3ステップ）
- ✅ `lib/screens/order/visual_ordering_screen.dart` - 視覚的発注画面（プレースホルダー）

**進捗**: 60% 🟡（実装確認必要）

### 2.2 MVP仕様で必要な画面（未実装・要確認）

#### 顧客管理画面 ✅
- ✅ `lib/screens/customers/customer_list_screen.dart` - 顧客一覧画面
- ✅ `lib/screens/customers/customer_detail_screen.dart` - 顧客詳細画面
- ✅ `lib/screens/customers/customer_create_screen.dart` - 新規顧客登録画面
- ✅ `lib/screens/customers/customer_edit_screen.dart` - 顧客編集画面

**進捗**: 100% ✅（ナビゲーションへの追加が必要）

#### 注文管理画面 ✅
- ✅ `lib/screens/orders/order_list_screen.dart` - 注文一覧画面
- ✅ `lib/screens/orders/order_detail_screen.dart` - 注文詳細画面
- ✅ `lib/screens/orders/order_confirm_screen.dart` - 注文確認画面
- ✅ `lib/screens/orders/compliance_document_screen.dart` - 発注書PDF表示画面

**進捗**: 100% ✅

#### クイック発注画面（改善必要）🟡
- ⚠️ `lib/screens/order/quick_order_screen.dart` - 3ステップ実装の確認
  - ステップ1: 顧客選択（既存顧客選択/新規登録）
  - ステップ2: 生地選択
  - ステップ3: 注文情報入力（金額、納期、採寸データ）

**優先度**: 🟡 中（既存実装の確認・改善）

#### ナビゲーション 🟡
- ⚠️ Bottom Navigation Bar（実装確認必要）
- ⚠️ App Bar（実装確認必要）

**優先度**: 🟡 中

---

## 3. データベース進捗

### 3.1 実装済みテーブル ✅

- ✅ `tenants` - テナント
- ✅ `users` - ユーザー
- ✅ `customers` - 顧客
- ✅ `orders` - 注文
- ✅ `order_items` - 注文明細
- ✅ `fabrics` - 生地
- ✅ `compliance_documents` - コンプライアンス文書

**進捗**: 100% ✅

### 3.2 MVP仕様との差分

**差分なし** - MVPで必要なテーブルはすべて実装済み ✅

---

## 4. 認証・セキュリティ進捗

### 4.1 実装済み ✅

- ✅ Firebase Authentication統合
- ✅ JWTトークン検証ミドルウェア
- ✅ RBAC（ロールベースアクセス制御）
- ✅ マルチテナントデータ分離

**進捗**: 100% ✅

---

## 5. コンプライアンス機能進捗

### 5.1 実装済み ✅

- ✅ 下請法対応発注書PDF生成
- ✅ 日本語フォント対応（Noto Sans JP）
- ✅ 修正発注書の履歴管理
- ✅ PDFハッシュによる改ざん検出
- ✅ インボイス制度対応（適格請求書PDF生成）

**進捗**: 90% 🟢

### 5.2 MVP仕様との差分

- ⚠️ PDFダウンロードエンドポイントの実装確認（`GET /api/compliance-documents/{id}/download`）

**優先度**: 🟡 中

---

## 6. インフラ構成進捗

### 6.1 未実装 🔴

- ❌ Google Cloud Run設定
- ❌ Cloud SQL設定
- ❌ Cloud Storage設定
- ❌ 環境変数設定
- ❌ CI/CDパイプライン

**進捗**: 0% 🔴

**優先度**: 🟡 中（開発環境ではローカルで動作可能）

---

## 7. テスト進捗

### 7.1 未実装 🔴

- ❌ ユニットテスト
- ❌ 統合テスト
- ❌ E2Eテスト
- ❌ 手動テスト手順書

**進捗**: 20% 🔴（一部手動テスト実施済み）

**優先度**: 🟡 中（MVPでは手動テストで対応可能）

---

## 8. 開発タスク優先順位

### 🔴 最優先（今週中に完了）

#### 1. 顧客管理画面の実装 ✅
**見積もり**: 2-3日（完了）

- [x] `customer_list_screen.dart` - 顧客一覧画面
  - 顧客リスト表示（カード形式）✅
  - 検索機能 ✅
  - 新規顧客登録ボタン ✅
  - ページネーション（API側で対応）✅

- [x] `customer_detail_screen.dart` - 顧客詳細画面
  - 顧客情報表示 ✅
  - 注文履歴一覧（注文管理画面へのリンク）✅
  - 編集ボタン ✅

- [x] `customer_create_screen.dart` - 新規顧客登録画面
  - 顧客情報入力フォーム ✅
  - バリデーション ✅
  - 保存機能 ✅

- [x] `customer_edit_screen.dart` - 顧客編集画面
  - 顧客情報編集フォーム ✅
  - 更新機能 ✅

**追加実装**:
- [x] APIクライアントにPUTメソッド追加 ✅
- [x] 顧客更新プロバイダー実装 ✅

**関連ファイル**:
- `lib/models/customer.dart` - モデル（既存）
- `lib/providers/customer_provider.dart` - プロバイダー（実装確認必要）
- `lib/services/api_client.dart` - APIクライアント（既存）

---

#### 2. 注文管理画面の実装 ✅
**見積もり**: 2-3日（完了）

- [x] `order_list_screen.dart` - 注文一覧画面
  - 注文リスト表示（カード形式）✅
  - ステータスフィルター✅
  - 検索機能✅
  - 顧客IDフィルター対応✅

- [x] `order_detail_screen.dart` - 注文詳細画面
  - 注文情報表示✅
  - 注文明細表示✅
  - 発注書PDF表示ボタン✅
  - 注文確定ボタン（Draftの場合）✅
  - 修正発注書生成ボタン（Confirmedの場合）✅

- [x] `order_confirm_screen.dart` - 注文確認画面
  - 注文情報の最終確認✅
  - 委託をする者の氏名入力✅
  - 発注書生成ボタン✅

- [x] `compliance_document_screen.dart` - 発注書PDF表示画面
  - PDF表示（外部ブラウザ）✅
  - PDFダウンロード機能✅

**追加実装**:
- [x] url_launcherパッケージ追加✅
- [x] ナビゲーションに注文管理を追加✅
- [x] 顧客詳細画面の注文履歴リンク修正✅

**関連ファイル**:
- `lib/models/order.dart` - モデル（既存）
- `lib/providers/order_provider.dart` - プロバイダー（実装確認必要）

---

#### 3. クイック発注画面の改善 ✅
**見積もり**: 1-2日（完了）

- [x] 3ステップフローの実装確認・改善 ✅
  - ステップインジケーター追加 ✅
  - ステップ1: 顧客選択（既存顧客選択/新規登録画面への遷移）✅
  - ステップ2: 生地選択 ✅
  - ステップ3: 注文情報入力（金額、納期、採寸データ）✅
  - 戻る/次へボタン実装 ✅
  - 注文作成後、注文確認画面への遷移 ✅

- [x] UI改善 ✅
  - ステップインジケーター（現在のステップを視覚的に表示）✅
  - 採寸データ入力欄追加（ジャケット長、袖長、胸囲）✅
  - エラーハンドリング改善 ✅

**関連ファイル**:
- `lib/screens/order/quick_order_screen.dart` - 改善版で置き換え完了 ✅

---

### 🟡 優先（来週中に完了）

#### 4. バックエンドAPIの動作確認・改善 🔄
**見積もり**: 1-2日（確認中）

**現状確認完了**:
- ✅ 基本的な注文作成機能は実装済み
- ✅ PDF生成・アップロード機能は実装済み
- ❌ order_items配列対応が未実装（スキーマには存在するが未使用）
- ❌ PDFダウンロードエンドポイントが未実装

**改善が必要な点**:
- [ ] `POST /api/orders` - order_items配列対応の実装
  - OrderItemモデルの追加
  - OrderItemRepositoryの実装
  - レスポンスにorder_items配列を含める

- [ ] `GET /api/orders/{id}/compliance-document/download` - PDFダウンロードエンドポイントの実装
  - Cloud StorageからPDFを取得して直接ダウンロード
  - 認証・認可の実装

**詳細**: `docs/101_Backend_API_Review.md`を参照
- [ ] `GET /api/orders/{id}` - 注文明細を含む詳細レスポンスの確認
- [ ] `GET /api/compliance-documents/{id}/download` - PDFダウンロードエンドポイントの実装確認

---

#### 5. 統合テスト・動作確認
**見積もり**: 1-2日

- [ ] 全画面の動作確認
- [ ] API連携の動作確認
- [ ] エラーハンドリングの確認
- [ ] UI/UXの調整

---

### 🟢 標準（時間があれば）

#### 6. インフラ構成の準備
**見積もり**: 2-3日

- [ ] Google Cloud Run設定
- [ ] Cloud SQL設定
- [ ] Cloud Storage設定
- [ ] 環境変数設定

**優先度**: 🟢 低（開発環境ではローカルで動作可能）

---

## 9. 週次開発スケジュール

### Week 1: 顧客管理・注文管理画面実装（今週）

**目標**: 顧客管理と注文管理の基本機能を実装

- [x] Day 1-2: 顧客管理画面実装 ✅
  - 顧客一覧画面 ✅
  - 顧客詳細画面 ✅
  - 新規顧客登録画面 ✅
  - 顧客編集画面 ✅
  - ナビゲーションへの追加 ✅
  - APIクライアントにPUTメソッド追加 ✅

- [ ] Day 3-4: 注文管理画面実装
  - 注文一覧画面
  - 注文詳細画面
  - 注文確認画面
  - 発注書PDF表示画面

- [ ] Day 5: 統合・動作確認
  - 画面間の遷移確認
  - API連携確認
  - エラーハンドリング確認

**進捗**: 50% → 目標: 40%（目標を上回る進捗）

---

### Week 2: クイック発注画面改善・統合テスト（来週）

**目標**: クイック発注画面の完成と全体の統合テスト

- [x] Day 1-2: クイック発注画面の改善 ✅
  - 3ステップフローの実装確認・改善 ✅
  - ステップインジケーター追加 ✅
  - 採寸データ入力欄追加 ✅
  - 注文確認画面への遷移実装 ✅

- [ ] Day 3: バックエンドAPIの動作確認・改善
  - order_items配列対応
  - 注文明細を含む詳細レスポンス
  - PDFダウンロードエンドポイント

- [ ] Day 4-5: 統合テスト・動作確認
  - 全画面の動作確認
  - API連携の動作確認
  - UI/UXの調整

**進捗**: 80% → 目標: 80%（目標達成）

---

### Week 3: 最終調整・テスト（3週目）

**目標**: MVP完成、10店舗でのテスト準備

- [ ] Day 1-2: 最終調整
  - UI/UXの最終調整
  - パフォーマンス最適化
  - エラーハンドリングの改善

- [ ] Day 3-4: テストデータ準備
  - テスト用テナント・顧客データ
  - テスト用注文データ
  - テスト手順書作成

- [ ] Day 5: ドキュメント整備
  - ユーザーガイド
  - 開発者ガイド
  - テスト手順書

**進捗**: 80% → 目標: 100%

---

### Week 4: 実証テスト・フィードバック収集（4週目）

**目標**: 10店舗での実証テスト、LOI取得

- [ ] Day 1-2: 実証テスト実施
  - 10店舗でのテスト
  - フィードバック収集

- [ ] Day 3-4: フィードバック反映
  - バグ修正
  - 機能改善

- [ ] Day 5: LOI取得・報告書作成
  - 利用意向書の取得
  - 実証テスト報告書

**進捗**: 100% → 目標: MVP完成 ✅

---

## 10. リスク管理

### 10.1 技術的リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| バックエンドAPIの動作不良 | 高 | 低 | 早期に動作確認・テスト実施 |
| フロントエンドの実装遅延 | 高 | 中 | 優先順位を明確化、週次レビュー |
| PDF生成の不具合 | 中 | 低 | 既存実装の動作確認 |

### 10.2 スケジュールリスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 開発期間の超過 | 高 | 中 | 週次進捗レビュー、優先順位の見直し |
| テスト期間の不足 | 中 | 中 | 早期にテスト実施、並行作業 |

---

## 11. 進捗更新方法

### 11.1 日次更新

- 毎日の終わりに進捗を更新
- 完了したタスクにチェックを入れる
- ブロッカーがあれば記録

### 11.2 週次レビュー

- 毎週金曜日に週次レビュー
- 進捗率を更新
- 来週の優先順位を確認

### 11.3 マイルストーン

- Week 1完了: 顧客管理・注文管理画面実装完了
- Week 2完了: クイック発注画面改善・統合テスト完了
- Week 3完了: MVP完成
- Week 4完了: 実証テスト完了、LOI取得

---

## 12. 次のアクション

### 【今すぐ実行】

1. **現状確認**
   - [ ] フロントエンドの既存実装を確認
   - [ ] バックエンドAPIの動作確認
   - [ ] データベースの状態確認

2. **開発環境の準備**
   - [ ] Flutter開発環境の確認
   - [ ] バックエンドサーバーの起動確認
   - [ ] データベース接続確認

3. **Week 1のタスク開始**
   - [ ] 顧客管理画面の実装開始
   - [ ] 注文管理画面の実装開始

---

## 13. 関連ドキュメント

- **[MVP技術仕様書](./95_MVP_Technical_Specification.md)** - 詳細な技術仕様
- **[視覚化図表](./96_MVP_Visual_Diagrams.md)** - ER図・画面遷移図
- **[完全システム仕様書](./72_Complete_System_Specification.md)** - 既存システム仕様
- **[APIリファレンス](./73_API_Reference.md)** - 既存API仕様
- **[現在のシステム状況](./81_Current_System_Status.md)** - 実装済み機能一覧

---

**最終更新日**: 2025-01  
**バージョン**: 1.0.0  
**ステータス**: 🟡 開発進行中（進捗: 約60%）

