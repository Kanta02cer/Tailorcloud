# Suit-MBTIçµ±åˆæ©Ÿèƒ½: æ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰ & æ‰‹å‹•ãƒ†ã‚¹ãƒˆãƒãƒ‹ãƒ¥ã‚¢ãƒ«

**ä½œæˆæ—¥**: 2025-01  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Phase 1 Week 1 å®Ÿè£…å®Œäº†

---

## ğŸ“‹ ç›®æ¬¡

1. [å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ä¸€è¦§](#å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ä¸€è¦§)
2. [ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±](#ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±)
3. [APIä½¿ç”¨æ–¹æ³•](#apiä½¿ç”¨æ–¹æ³•)
4. [æ‰‹å‹•ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰](#æ‰‹å‹•ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰)
5. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ä¸€è¦§

### 1. è¨ºæ–­ç®¡ç†æ©Ÿèƒ½ï¼ˆDiagnosisï¼‰

**æ©Ÿèƒ½æ¦‚è¦**: Suit-MBTIè¨ºæ–­çµæœã‚’TailorCloudã«çµ±åˆã—ã€è¨ºæ–­å±¥æ­´ã‚’ç®¡ç†

**å®Ÿè£…å†…å®¹**:
- âœ… è¨ºæ–­çµæœã®ç™»éŒ²ï¼ˆã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã€ãƒ—ãƒ©ãƒ³ã‚¿ã‚¤ãƒ—ï¼‰
- âœ… è¨ºæ–­å±¥æ­´ã®å–å¾—ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã€ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ï¼‰
- âœ… è¨ºæ–­çµæœã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¤œç´¢

**ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**:
- ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ï¼ˆRATã‚¿ã‚¤ãƒ—ï¼‰: Classic, Modern, Elegant, Sporty, Casual
- ãƒ—ãƒ©ãƒ³ã‚¿ã‚¤ãƒ—: Best Value, Authentic
- è¨ºæ–­çµæœè©³ç´°ï¼ˆJSONå½¢å¼ï¼‰

---

### 2. äºˆç´„ç®¡ç†æ©Ÿèƒ½ï¼ˆAppointmentï¼‰

**æ©Ÿèƒ½æ¦‚è¦**: ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°äºˆç´„ã®ç®¡ç†ã¨ç©ºãçŠ¶æ³ãƒã‚§ãƒƒã‚¯

**å®Ÿè£…å†…å®¹**:
- âœ… äºˆç´„ã®ä½œæˆï¼ˆæ—¥æ™‚ã€ãƒ•ã‚£ãƒƒã‚¿ãƒ¼ã€é¡§å®¢ï¼‰
- âœ… äºˆç´„ã®å–å¾—ãƒ»ä¸€è¦§è¡¨ç¤º
- âœ… äºˆç´„ã®æ›´æ–°ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«
- âœ… ç©ºãçŠ¶æ³ãƒã‚§ãƒƒã‚¯ï¼ˆæ™‚é–“é‡è¤‡é˜²æ­¢ï¼‰
- âœ… æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆé–‹å§‹æ—¥ãƒ»çµ‚äº†æ—¥ï¼‰

**ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**:
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: Pending, Confirmed, Cancelled, Completed, NoShow
- ãƒ‡ãƒã‚¸ãƒƒãƒˆç®¡ç†ï¼ˆStripeé€£æºæº–å‚™æ¸ˆã¿ï¼‰
- ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç†ç”±ã®è¨˜éŒ²

---

## ğŸ¯ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±

### ä¸»è¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

#### 1. ãƒ†ãƒ¼ãƒ©ãƒ¼ï¼ˆTailorï¼‰

**å±æ€§**:
- å€‹äººãƒ†ãƒ¼ãƒ©ãƒ¼ã€ç‹¬ç«‹ç³»ãƒ†ãƒ¼ãƒ©ãƒ¼
- å¹´å•†3,000ä¸‡ã€œ1å„„å††
- äº‹å‹™ä½œæ¥­ã®åŠ¹ç‡åŒ–ã‚’å¸Œæœ›

**åˆ©ç”¨ã‚·ãƒ¼ãƒ³**:
- é¡§å®¢ã®è¨ºæ–­çµæœã‚’ç¢ºèªã—ã¦é©åˆ‡ãªãƒ—ãƒ©ãƒ³ã‚’ææ¡ˆ
- ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°äºˆç´„ã®ç®¡ç†
- é¡§å®¢ã®è¨ºæ–­å±¥æ­´ã‚’å‚ç…§ã—ã¦ãƒªãƒ”ãƒ¼ãƒˆææ¡ˆ

**ä½¿ç”¨æ©Ÿèƒ½**:
- è¨ºæ–­å±¥æ­´ã®é–²è¦§
- äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ç®¡ç†
- é¡§å®¢ã‚«ãƒ«ãƒ†ï¼ˆè¨ºæ–­çµæœå«ã‚€ï¼‰

---

#### 2. ã‚¹ã‚¿ãƒƒãƒ•ï¼ˆStaffï¼‰

**å±æ€§**:
- ãƒ†ãƒ¼ãƒ©ãƒ¼ã®å¾“æ¥­å“¡
- æ¥å®¢æ¥­å‹™ã‚’æ‹…å½“

**åˆ©ç”¨ã‚·ãƒ¼ãƒ³**:
- æ¥å®¢æ™‚ã«è¨ºæ–­çµæœã‚’ç¢ºèª
- ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°äºˆç´„ã®ä½œæˆãƒ»å¤‰æ›´

**ä½¿ç”¨æ©Ÿèƒ½**:
- è¨ºæ–­å±¥æ­´ã®é–²è¦§
- äºˆç´„ã®ä½œæˆãƒ»æ›´æ–°
- ç©ºãçŠ¶æ³ã®ç¢ºèª

---

#### 3. é¡§å®¢ï¼ˆCustomer/Userï¼‰

**å±æ€§**:
- Suit-MBTIè¨ºæ–­ã‚’å—ã‘ãŸé¡§å®¢
- ã‚ªãƒ¼ãƒ€ãƒ¼ã‚¹ãƒ¼ãƒ„ã‚’è³¼å…¥æ¤œè¨ä¸­

**åˆ©ç”¨ã‚·ãƒ¼ãƒ³**:
- è¨ºæ–­çµæœã®ç¢ºèª
- ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°äºˆç´„ã®ç¢ºèªãƒ»å¤‰æ›´

**ä½¿ç”¨æ©Ÿèƒ½**:
- è‡ªåˆ†ã®è¨ºæ–­å±¥æ­´ã®é–²è¦§
- è‡ªåˆ†ã®äºˆç´„ã®ç¢ºèªãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«

---

## ğŸ”Œ APIä½¿ç”¨æ–¹æ³•

### ãƒ™ãƒ¼ã‚¹URL

```
http://localhost:8080
```

### èªè¨¼

ã™ã¹ã¦ã®APIã¯èªè¨¼ãŒå¿…è¦ã§ã™ï¼ˆé–‹ç™ºç’°å¢ƒã§ã¯OptionalAuthãŒæœ‰åŠ¹ï¼‰ã€‚

**ãƒ˜ãƒƒãƒ€ãƒ¼**:
```
Authorization: Bearer <JWT_TOKEN>
```

é–‹ç™ºç’°å¢ƒã§ã¯ã€èªè¨¼ãªã—ã§ã‚‚`tenant_id`ã‚’ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã™ã‚Œã°å‹•ä½œã—ã¾ã™ã€‚

---

### 1. è¨ºæ–­ç®¡ç†API

#### 1.1 è¨ºæ–­çµæœã®ç™»éŒ²

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `POST /api/diagnoses`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "user_id": "user_12345",
  "archetype": "Classic",
  "plan_type": "Best Value",
  "diagnosis_result": {
    "scores": {
      "classic": 85,
      "modern": 20,
      "elegant": 70,
      "sporty": 30,
      "casual": 45
    },
    "recommendations": ["Classic", "Elegant"]
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `201 Created`
```json
{
  "id": "diagnosis_001",
  "user_id": "user_12345",
  "tenant_id": "tenant_001",
  "archetype": "Classic",
  "plan_type": "Best Value",
  "diagnosis_result": {...},
  "created_at": "2025-01-01T00:00:00Z",
  "updated_at": "2025-01-01T00:00:00Z"
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl -X POST http://localhost:8080/api/diagnoses?tenant_id=tenant_001 \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "user_12345",
    "archetype": "Classic",
    "plan_type": "Best Value",
    "diagnosis_result": {"scores": {"classic": 85}}
  }'
```

---

#### 1.2 è¨ºæ–­çµæœã®å–å¾—ï¼ˆå˜ä¸€ï¼‰

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `GET /api/diagnoses/{id}`

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `tenant_id` (å¿…é ˆ)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `200 OK`
```json
{
  "id": "diagnosis_001",
  "user_id": "user_12345",
  "tenant_id": "tenant_001",
  "archetype": "Classic",
  "plan_type": "Best Value",
  "diagnosis_result": {...},
  "created_at": "2025-01-01T00:00:00Z",
  "updated_at": "2025-01-01T00:00:00Z"
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl "http://localhost:8080/api/diagnoses/diagnosis_001?tenant_id=tenant_001"
```

---

#### 1.3 è¨ºæ–­å±¥æ­´ã®ä¸€è¦§å–å¾—

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `GET /api/diagnoses`

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `tenant_id` (å¿…é ˆ)
- `user_id` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- `archetype` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- `plan_type` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ãƒ—ãƒ©ãƒ³ã‚¿ã‚¤ãƒ—ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- `limit` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ä»¶æ•°åˆ¶é™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20ã€æœ€å¤§: 100ï¼‰
- `offset` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0ï¼‰

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `200 OK`
```json
{
  "data": [
    {
      "id": "diagnosis_001",
      "user_id": "user_12345",
      "archetype": "Classic",
      "plan_type": "Best Value",
      ...
    },
    {
      "id": "diagnosis_002",
      "user_id": "user_12346",
      "archetype": "Modern",
      "plan_type": "Authentic",
      ...
    }
  ],
  "total": 2
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
# å…¨è¨ºæ–­å±¥æ­´ã‚’å–å¾—
curl "http://localhost:8080/api/diagnoses?tenant_id=tenant_001"

# ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã«å–å¾—
curl "http://localhost:8080/api/diagnoses?tenant_id=tenant_001&user_id=user_12345"

# ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
curl "http://localhost:8080/api/diagnoses?tenant_id=tenant_001&archetype=Classic"

# ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
curl "http://localhost:8080/api/diagnoses?tenant_id=tenant_001&limit=10&offset=0"
```

---

### 2. äºˆç´„ç®¡ç†API

#### 2.1 äºˆç´„ã®ä½œæˆ

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `POST /api/appointments`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "user_id": "user_12345",
  "fitter_id": "fitter_001",
  "appointment_datetime": "2025-01-15T14:00:00Z",
  "duration_minutes": 60,
  "notes": "åˆå›ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `201 Created`
```json
{
  "id": "appointment_001",
  "user_id": "user_12345",
  "tenant_id": "tenant_001",
  "fitter_id": "fitter_001",
  "appointment_datetime": "2025-01-15T14:00:00Z",
  "duration_minutes": 60,
  "status": "Pending",
  "notes": "åˆå›ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°",
  "created_at": "2025-01-01T00:00:00Z",
  "updated_at": "2025-01-01T00:00:00Z"
}
```

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**:
- äºˆç´„æ—¥æ™‚ã¯æœªæ¥ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
- æ™‚é–“é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼ˆåŒã˜ãƒ•ã‚£ãƒƒã‚¿ãƒ¼ãƒ»åŒã˜æ™‚é–“å¸¯ï¼‰
- äºˆç´„æ™‚é–“ã¯æœ€å¤§8æ™‚é–“ï¼ˆ480åˆ†ï¼‰

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl -X POST http://localhost:8080/api/appointments?tenant_id=tenant_001 \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "user_12345",
    "fitter_id": "fitter_001",
    "appointment_datetime": "2025-01-15T14:00:00Z",
    "duration_minutes": 60,
    "notes": "åˆå›ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°"
  }'
```

---

#### 2.2 äºˆç´„ã®å–å¾—ï¼ˆå˜ä¸€ï¼‰

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `GET /api/appointments/{id}`

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `tenant_id` (å¿…é ˆ)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `200 OK`
```json
{
  "id": "appointment_001",
  "user_id": "user_12345",
  "tenant_id": "tenant_001",
  "fitter_id": "fitter_001",
  "appointment_datetime": "2025-01-15T14:00:00Z",
  "duration_minutes": 60,
  "status": "Confirmed",
  ...
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl "http://localhost:8080/api/appointments/appointment_001?tenant_id=tenant_001"
```

---

#### 2.3 äºˆç´„ä¸€è¦§ã®å–å¾—

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `GET /api/appointments`

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `tenant_id` (å¿…é ˆ)
- `user_id` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- `fitter_id` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): ãƒ•ã‚£ãƒƒã‚¿ãƒ¼IDã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- `start_date` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): é–‹å§‹æ—¥ï¼ˆISO 8601å½¢å¼ï¼‰
- `end_date` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): çµ‚äº†æ—¥ï¼ˆISO 8601å½¢å¼ï¼‰

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `200 OK`
```json
{
  "data": [
    {
      "id": "appointment_001",
      "user_id": "user_12345",
      "fitter_id": "fitter_001",
      "appointment_datetime": "2025-01-15T14:00:00Z",
      "status": "Confirmed",
      ...
    }
  ],
  "total": 1
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
# å…¨äºˆç´„ã‚’å–å¾—
curl "http://localhost:8080/api/appointments?tenant_id=tenant_001"

# ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã«å–å¾—
curl "http://localhost:8080/api/appointments?tenant_id=tenant_001&user_id=user_12345"

# ãƒ•ã‚£ãƒƒã‚¿ãƒ¼åˆ¥ã«å–å¾—
curl "http://localhost:8080/api/appointments?tenant_id=tenant_001&fitter_id=fitter_001"

# æœŸé–“æŒ‡å®š
curl "http://localhost:8080/api/appointments?tenant_id=tenant_001&start_date=2025-01-01T00:00:00Z&end_date=2025-01-31T23:59:59Z"
```

---

#### 2.4 äºˆç´„ã®æ›´æ–°

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `PUT /api/appointments/{id}`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "fitter_id": "fitter_002",
  "appointment_datetime": "2025-01-15T15:00:00Z",
  "duration_minutes": 90,
  "status": "Confirmed",
  "notes": "æ™‚é–“å¤‰æ›´"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `200 OK`
```json
{
  "id": "appointment_001",
  ...
  "appointment_datetime": "2025-01-15T15:00:00Z",
  "status": "Confirmed",
  ...
}
```

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl -X PUT http://localhost:8080/api/appointments/appointment_001?tenant_id=tenant_001 \
  -H "Content-Type: application/json" \
  -d '{
    "status": "Confirmed",
    "notes": "ç¢ºèªæ¸ˆã¿"
  }'
```

---

#### 2.5 äºˆç´„ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `DELETE /api/appointments/{id}`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):
```json
{
  "reason": "æ€¥ç”¨ãŒã§ããŸãŸã‚"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: `204 No Content`

**ä½¿ç”¨ä¾‹ï¼ˆcurlï¼‰**:
```bash
curl -X DELETE http://localhost:8080/api/appointments/appointment_001?tenant_id=tenant_001 \
  -H "Content-Type: application/json" \
  -d '{"reason": "æ€¥ç”¨ãŒã§ããŸãŸã‚"}'
```

---

## ğŸ§ª æ‰‹å‹•ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰

### ãƒ†ã‚¹ãƒˆç’°å¢ƒã®æº–å‚™

#### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

```bash
cd tailor-cloud-backend

# PostgreSQLæ¥ç¶šæƒ…å ±ã‚’ç’°å¢ƒå¤‰æ•°ã§è¨­å®š
export POSTGRES_HOST=localhost
export POSTGRES_PORT=5432
export POSTGRES_USER=your_user
export POSTGRES_PASSWORD=your_password
export POSTGRES_DB=tailorcloud

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
psql -h $POSTGRES_HOST -p $POSTGRES_PORT -U $POSTGRES_USER -d $POSTGRES_DB -f migrations/013_create_diagnoses_table.sql
psql -h $POSTGRES_HOST -p $POSTGRES_PORT -U $POSTGRES_USER -d $POSTGRES_DB -f migrations/014_create_appointments_table.sql
psql -h $POSTGRES_HOST -p $POSTGRES_PORT -U $POSTGRES_USER -d $POSTGRES_DB -f migrations/015_extend_customers_for_suit_mbti.sql
```

#### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
cd tailor-cloud-backend
./scripts/start_backend.sh
# ã¾ãŸã¯
go run cmd/api/main.go
```

ã‚µãƒ¼ãƒãƒ¼ã¯ `http://localhost:8080` ã§èµ·å‹•ã—ã¾ã™ã€‚

---

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

#### ã‚·ãƒŠãƒªã‚ª 1: è¨ºæ–­çµæœã®ç™»éŒ²ã¨å–å¾—

**ç›®çš„**: è¨ºæ–­çµæœã‚’ç™»éŒ²ã—ã€æ­£å¸¸ã«å–å¾—ã§ãã‚‹ã“ã¨ã‚’ç¢ºèª

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **è¨ºæ–­çµæœã‚’ç™»éŒ²**
   ```bash
   curl -X POST http://localhost:8080/api/diagnoses?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "user_id": "user_test_001",
       "archetype": "Classic",
       "plan_type": "Best Value",
       "diagnosis_result": {
         "scores": {"classic": 85, "modern": 20},
         "recommendations": ["Classic"]
       }
     }'
   ```
   
   **æœŸå¾…çµæœ**: `201 Created`ã€è¨ºæ–­IDãŒè¿”ã•ã‚Œã‚‹

2. **è¨ºæ–­çµæœã‚’å–å¾—**
   ```bash
   # ã‚¹ãƒ†ãƒƒãƒ—1ã§å–å¾—ã—ãŸè¨ºæ–­IDã‚’ä½¿ç”¨
   curl "http://localhost:8080/api/diagnoses/{diagnosis_id}?tenant_id=tenant_test"
   ```
   
   **æœŸå¾…çµæœ**: `200 OK`ã€ç™»éŒ²ã—ãŸè¨ºæ–­çµæœãŒè¿”ã•ã‚Œã‚‹

3. **è¨ºæ–­å±¥æ­´ä¸€è¦§ã‚’å–å¾—**
   ```bash
   curl "http://localhost:8080/api/diagnoses?tenant_id=tenant_test&user_id=user_test_001"
   ```
   
   **æœŸå¾…çµæœ**: `200 OK`ã€ã‚¹ãƒ†ãƒƒãƒ—1ã§ç™»éŒ²ã—ãŸè¨ºæ–­ãŒå«ã¾ã‚Œã‚‹

---

#### ã‚·ãƒŠãƒªã‚ª 2: äºˆç´„ã®ä½œæˆã¨ç©ºãçŠ¶æ³ãƒã‚§ãƒƒã‚¯

**ç›®çš„**: äºˆç´„ã‚’ä½œæˆã—ã€ç©ºãçŠ¶æ³ãƒã‚§ãƒƒã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **äºˆç´„ã‚’ä½œæˆ**
   ```bash
   curl -X POST http://localhost:8080/api/appointments?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "user_id": "user_test_001",
       "fitter_id": "fitter_test_001",
       "appointment_datetime": "2025-01-20T14:00:00Z",
       "duration_minutes": 60,
       "notes": "åˆå›ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°"
     }'
   ```
   
   **æœŸå¾…çµæœ**: `201 Created`ã€äºˆç´„IDãŒè¿”ã•ã‚Œã‚‹

2. **é‡è¤‡äºˆç´„ã‚’è©¦ã¿ã‚‹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ†ã‚¹ãƒˆï¼‰**
   ```bash
   # åŒã˜ãƒ•ã‚£ãƒƒã‚¿ãƒ¼ãƒ»åŒã˜æ™‚é–“ã§äºˆç´„ã‚’è©¦ã¿ã‚‹
   curl -X POST http://localhost:8080/api/appointments?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "user_id": "user_test_002",
       "fitter_id": "fitter_test_001",
       "appointment_datetime": "2025-01-20T14:00:00Z",
       "duration_minutes": 60
     }'
   ```
   
   **æœŸå¾…çµæœ**: `409 Conflict`ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œnot availableã€ã¨è¿”ã•ã‚Œã‚‹

3. **äºˆç´„ä¸€è¦§ã‚’å–å¾—ï¼ˆæœŸé–“æŒ‡å®šï¼‰**
   ```bash
   curl "http://localhost:8080/api/appointments?tenant_id=tenant_test&fitter_id=fitter_test_001&start_date=2025-01-01T00:00:00Z&end_date=2025-01-31T23:59:59Z"
   ```
   
   **æœŸå¾…çµæœ**: `200 OK`ã€ã‚¹ãƒ†ãƒƒãƒ—1ã§ä½œæˆã—ãŸäºˆç´„ãŒå«ã¾ã‚Œã‚‹

---

#### ã‚·ãƒŠãƒªã‚ª 3: äºˆç´„ã®æ›´æ–°ã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«

**ç›®çš„**: äºˆç´„ã®æ›´æ–°ã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **äºˆç´„ã‚’æ›´æ–°**
   ```bash
   # ã‚¹ãƒ†ãƒƒãƒ—1ã§å–å¾—ã—ãŸäºˆç´„IDã‚’ä½¿ç”¨
   curl -X PUT http://localhost:8080/api/appointments/{appointment_id}?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "status": "Confirmed",
       "notes": "ç¢ºèªæ¸ˆã¿"
     }'
   ```
   
   **æœŸå¾…çµæœ**: `200 OK`ã€æ›´æ–°ã•ã‚ŒãŸäºˆç´„æƒ…å ±ãŒè¿”ã•ã‚Œã‚‹

2. **äºˆç´„ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«**
   ```bash
   curl -X DELETE http://localhost:8080/api/appointments/{appointment_id}?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "reason": "ãƒ†ã‚¹ãƒˆã‚­ãƒ£ãƒ³ã‚»ãƒ«"
     }'
   ```
   
   **æœŸå¾…çµæœ**: `204 No Content`

3. **ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸäºˆç´„ã‚’å–å¾—**
   ```bash
   curl "http://localhost:8080/api/appointments/{appointment_id}?tenant_id=tenant_test"
   ```
   
   **æœŸå¾…çµæœ**: `200 OK`ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€ŒCancelledã€ã«ãªã£ã¦ã„ã‚‹

---

#### ã‚·ãƒŠãƒªã‚ª 4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

**ç›®çš„**: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¬ å¦‚ï¼ˆè¨ºæ–­ç™»éŒ²ï¼‰**
   ```bash
   curl -X POST http://localhost:8080/api/diagnoses?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "archetype": "Classic"
     }'
   ```
   
   **æœŸå¾…çµæœ**: `400 Bad Request`ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œuser_id is requiredã€ã¨è¿”ã•ã‚Œã‚‹

2. **ç„¡åŠ¹ãªã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ï¼ˆè¨ºæ–­ç™»éŒ²ï¼‰**
   ```bash
   curl -X POST http://localhost:8080/api/diagnoses?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "user_id": "user_test_001",
       "archetype": "InvalidType"
     }'
   ```
   
   **æœŸå¾…çµæœ**: `400 Bad Request`ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œinvalid archetypeã€ã¨è¿”ã•ã‚Œã‚‹

3. **éå»ã®æ—¥æ™‚ã§äºˆç´„ä½œæˆ**
   ```bash
   curl -X POST http://localhost:8080/api/appointments?tenant_id=tenant_test \
     -H "Content-Type: application/json" \
     -d '{
       "user_id": "user_test_001",
       "fitter_id": "fitter_test_001",
       "appointment_datetime": "2020-01-01T14:00:00Z",
       "duration_minutes": 60
     }'
   ```
   
   **æœŸå¾…çµæœ**: `400 Bad Request`ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œmust be in the futureã€ã¨è¿”ã•ã‚Œã‚‹

4. **å­˜åœ¨ã—ãªã„äºˆç´„ã‚’å–å¾—**
   ```bash
   curl "http://localhost:8080/api/appointments/nonexistent_id?tenant_id=tenant_test"
   ```
   
   **æœŸå¾…çµæœ**: `404 Not Found`ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œnot foundã€ã¨è¿”ã•ã‚Œã‚‹

---

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: 
```
ERROR: Failed to connect to PostgreSQL
```

**è§£æ±ºæ–¹æ³•**:
- PostgreSQLãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- ç’°å¢ƒå¤‰æ•°ï¼ˆPOSTGRES_HOST, POSTGRES_USERç­‰ï¼‰ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

```bash
# PostgreSQLæ¥ç¶šç¢ºèª
psql -h $POSTGRES_HOST -p $POSTGRES_PORT -U $POSTGRES_USER -d $POSTGRES_DB -c "SELECT 1"
```

---

#### 2. ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
ERROR: relation "diagnoses" does not exist
```

**è§£æ±ºæ–¹æ³•**:
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ

```bash
cd tailor-cloud-backend
psql -h $POSTGRES_HOST -U $POSTGRES_USER -d $POSTGRES_DB -f migrations/013_create_diagnoses_table.sql
```

---

#### 3. èªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
ERROR: Authentication required
```

**è§£æ±ºæ–¹æ³•**:
- é–‹ç™ºç’°å¢ƒã§ã¯`tenant_id`ã‚’ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®š
- æœ¬ç•ªç’°å¢ƒã§ã¯JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’`Authorization`ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¨­å®š

---

#### 4. äºˆç´„æ™‚é–“é‡è¤‡ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
ERROR: appointment time slot is not available
```

**è§£æ±ºæ–¹æ³•**:
- ç•°ãªã‚‹æ™‚é–“å¸¯ã‚’æŒ‡å®š
- ç•°ãªã‚‹ãƒ•ã‚£ãƒƒã‚¿ãƒ¼ã‚’æŒ‡å®š
- æ—¢å­˜ã®äºˆç´„ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«

---

## ğŸ“Š ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### è¨ºæ–­API

- [ ] è¨ºæ–­çµæœã®ç™»éŒ²ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] è¨ºæ–­çµæœã®å–å¾—ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] è¨ºæ–­å±¥æ­´ä¸€è¦§ã®å–å¾—ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ãƒ—ãƒ©ãƒ³ã‚¿ã‚¤ãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
- [ ] å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¬ å¦‚ã‚¨ãƒ©ãƒ¼
- [ ] ç„¡åŠ¹ãªã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã‚¨ãƒ©ãƒ¼

### äºˆç´„API

- [ ] äºˆç´„ã®ä½œæˆï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] äºˆç´„ã®å–å¾—ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] äºˆç´„ä¸€è¦§ã®å–å¾—ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] äºˆç´„ã®æ›´æ–°ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] äºˆç´„ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ãƒ•ã‚£ãƒƒã‚¿ãƒ¼åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] æ™‚é–“é‡è¤‡ãƒã‚§ãƒƒã‚¯
- [ ] éå»ã®æ—¥æ™‚ã‚¨ãƒ©ãƒ¼
- [ ] å­˜åœ¨ã—ãªã„äºˆç´„å–å¾—ã‚¨ãƒ©ãƒ¼

---

**æœ€çµ‚æ›´æ–°æ—¥**: 2025-01  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0

